<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>JDemetra+ documentation - SEATS decomposition</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./M-Trend-Estimation-Local-Polynomials.html" rel="next">
<link href="./M-STL-decomposition.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./P_Methods.html">Methods</a></li><li class="breadcrumb-item"><a href="./M-SEATS-decomposition.html">SEATS decomposition</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">JDemetra+ documentation</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./G-what-is-jd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">JDemetra+ Software</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./G-jd-history.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How JDemetra+ came to be</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./P_Algorithms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Algorithms</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A-sa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Seasonal Adjustment</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A-sa-hf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Seasonal adjustment of high-frequency data</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A-outlier-detection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Outlier detection and external regressors</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A-calendar-correction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Calendar correction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A-benchmarking.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Benchmarking and temporal disagreggation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A-trend-cycle-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Trend-cycle estimation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A-nowcasting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Nowcasting</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./P_Tools.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tools</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./T-graphical-user-interface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Graphical User Interface</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./T-r-packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using JDemetra+ in R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./T-Production-tools-cruncher-QR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Production, Cruncher and quality report</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./T-rev-policies-production.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Production and revision policies</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./T-plug-ins.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Plug-ins for JDemetra+</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./P_Methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Methods</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./M-spectral-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spectral Analysis Principles and Tools</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./M-reg-arima-modelling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reg-Arima models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./M-X11-decomposition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">X-11 decomposition</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./M-STL-decomposition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">STL: Local regression decomposition</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./M-SEATS-decomposition.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">SEATS decomposition</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./M-Trend-Estimation-Local-Polynomials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Trend Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./M-tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./M-state-space-framework.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">State space modelling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./M-Temp-Disagg-Bench.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Temporal disaggregation and benchmarking</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#arima-modellling-of-the-input-series" id="toc-arima-modellling-of-the-input-series" class="nav-link" data-scroll-target="#arima-modellling-of-the-input-series">ARIMA modellling of the input series</a></li>
  <li><a href="#derivation-of-the-models-for-the-components" id="toc-derivation-of-the-models-for-the-components" class="nav-link" data-scroll-target="#derivation-of-the-models-for-the-components">Derivation of the models for the components</a></li>
  <li><a href="#estimation-of-the-components-with-the-wiener-kolmogorow-filter" id="toc-estimation-of-the-components-with-the-wiener-kolmogorow-filter" class="nav-link" data-scroll-target="#estimation-of-the-components-with-the-wiener-kolmogorow-filter">Estimation of the components with the Wiener-Kolmogorow filter</a></li>
  <li><a href="#psie-weights" id="toc-psie-weights" class="nav-link" data-scroll-target="#psie-weights">PsiE-weights</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">SEATS decomposition</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Under construction.</p>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>SEATS is a program for estimating unobserved components in a time series. It follows the ARIMA-model-based (AMB) method, developed from the work of CLEVELAND, W.P., and TIAO, G.C. (1976), BURMAN, J.P. (1980), HILLMER, S.C., and TIAO, G.C. (1982), BELL, W.R., and HILLMER, S.C. (1984) and MARAVALL, A., and PIERCE, D.A. (1987).</p>
<p>In JDemetra+ the input for the model based signal extraction procedure is always provided by TRAMO and includes the original series <span class="math inline">\(y_{t}\)</span>, the linearized series <span class="math inline">\(x_{t}\)</span> (i.e.&nbsp;the original series <span class="math inline">\(y_{t}\)</span> with the deterministic effects removed), the ARIMA model for the stochastic (linearized) time series <span class="math inline">\(x_{t}\)</span> and the deterministic effects (calendar effects, outliers and other regression variable effects)<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. SEATS decomposes the linearized series (and the ARIMA model) into trend, seasonal, transitory and irregular components, provides forecasts for these components, together with the associated standard errors, and finally assign the deterministic effects to each component yielding the <em>final</em> components<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. The Minimum Mean Square Error (MMSE) estimators of the components are computed with a Wiener-Kolmogorov filter applied to the finite series extended with forecasts and backcasts<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>.</p>
</section>
<section id="arima-modellling-of-the-input-series" class="level2">
<h2 class="anchored" data-anchor-id="arima-modellling-of-the-input-series">ARIMA modellling of the input series</h2>
<p>One of the fundamental assumptions made by SEATS is that the linearized time series <span class="math inline">\(x_{t}\)</span> follows the ARIMA model</p>
<p><span id="eq-1"><span class="math display">\[
\phi(B)\delta\left( B \right)x_{t} = \theta(B)a_{t}
\tag{1}\]</span></span> <!---\[7.25\]--></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(B\)</span> – the backshift operator <span class="math inline">\((Bx_{t} = x_{t - 1})\)</span>;</p></li>
<li><p><span class="math inline">\(\delta\left( B \right)\)</span> – a non-stationary autoregressive (AR) polynomial in <span class="math inline">\(B\)</span> (unit roots);</p></li>
<li><p><span class="math inline">\(\theta\left( B \right)\)</span> – an invertible moving average (MA) polynomial in <span class="math inline">\(B\)</span> and in <span class="math inline">\(B^{S}\)</span>, which can be expressed in the multiplicative form <span class="math inline">\(\left( 1 + \vartheta_{1}B + \ldots{+ \ \vartheta}{q}B^{q} \right)\left( \ 1 + \Theta{1}B^{s} + \ldots{+ \ \Theta}_{Q}B^{\text{sQ}} \right)\)</span> ;</p></li>
<li><p><span class="math inline">\(\phi(B)\)</span> – a stationary autoregressive (AR) polynomial in <span class="math inline">\(B\)</span> and in <span class="math inline">\(B^{S}\)</span> containing regular and seasonal unit roots, with <em>s</em> representing the number of observations per year;</p></li>
<li><p><span class="math inline">\(a_{t}\)</span> – a white-noise variable with the variance<span class="math inline">\(\ V(a)\)</span>.</p></li>
</ul>
<p>It should be noted that the stochastic time series can be predicted using its past observations and making an error. The variable <span class="math inline">\(a_{t}\)</span>, which is assumed to be white noise, is the fundamental <em>innovation</em> to the series at time <em>t</em>, that is the part that cannot be predicted based on the past history of the series.</p>
<p>Denoting <span class="math inline">\(\varphi\left( B \right) = \phi\left( B \right)\delta\left( B \right)\)</span>, <a href="M-tests.html#eq-1">Equation&nbsp;<span>1</span></a> <!---\[7.25\]--> can be written in a more concise form as</p>
<p><span id="eq-2"><span class="math display">\[
\varphi\left( B \right)x_{t} = \theta(B)a_{t}
\tag{2}\]</span></span> <!---\[7.26\]--></p>
<p>where <span class="math inline">\(\varphi\left( B \right)\)</span> contains both the stationary and the nonstationary roots.</p>
</section>
<section id="derivation-of-the-models-for-the-components" class="level2">
<h2 class="anchored" data-anchor-id="derivation-of-the-models-for-the-components">Derivation of the models for the components</h2>
<p>Let us consider the additive decomposition model</p>
<p><span id="eq-3"><span class="math display">\[
x_{t} = \sum_{i = 1}^{k}x_{\text{it}}
\tag{3}\]</span></span> <!---\[7.27\]--></p>
<p>where <em>i</em> refers to the orthogonal components: trend, seasonal, transitory or irregular. Apart from the irregular component, supposed to be a white noise, it is assumed that each component follows the ARIMA model which can be represented, using the notation of <a href="M-tests.html#eq-2">Equation&nbsp;<span>2</span></a> <!---\[7.26\]-->, as:</p>
<p><span id="eq-4"><span class="math display">\[
\varphi_{i}\left( B \right)\ x_{\text{it}} = \theta_{i}(B)a_{\text{it}}
\tag{4}\]</span></span> <!---\[7.28\]--></p>
<p>where</p>
<ul>
<li><p><span class="math inline">\(\varphi_{i}\left( B \right) = \phi_{i}\left( B \right)\delta_{i}\left( B \right),\ \ x_{\text{it}}\)</span> is the <em>i</em>-<em>th</em> unobserved component,</p></li>
<li><p><span class="math inline">\(\varphi_{i}\left( B \right)\)</span> and <span class="math inline">\(\theta_{i}\left( B \right)\)</span> are finite polynomials of order <span class="math inline">\(p_{i}\)</span> and <span class="math inline">\(q_{i}\)</span>, respectively,</p></li>
<li><p><span class="math inline">\(a_{\text{it}}\)</span>, the disturbance associated with such component, is a white noise process with zero mean and constant variance <span class="math inline">\(V(a_{i})\)</span> and <span class="math inline">\(a_{\text{it}}\)</span> and <span class="math inline">\(a_{\text{jt}}\)</span> are not correlated for <span class="math inline">\(i \neq j\)</span> and for any <span class="math inline">\(t\)</span>..</p></li>
</ul>
<p>These disturbances are functions of the innovations in the series and are called “pseudo-innovations” in the literature concerning the AMB decomposition as they refer to the components that are never observed <a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>. In the JDemetra+ documentation the term “innovations” is used to refer to the “pseudo-innovations”.</p>
<p>The following assumptions hold for <a href="#eq-4">Equation&nbsp;<span>4</span></a> <!---\[7.28\]-->. For each <span class="math inline">\(\text{i}\)</span> the polynomials <span class="math inline">\(\phi_{i}\left( B \right)\)</span>, <span class="math inline">\(\delta_{i}\left( B \right)\)</span> and <span class="math inline">\(\theta_{i}(B)\)</span> are prime and of finite order. The roots of <span class="math inline">\(\delta_{i}\left( B \right)\)</span> lies on the unit circle; those of <span class="math inline">\(\phi_{i}\left( B \right)\)</span> lie outside, while all the roots of <span class="math inline">\(\theta_{i}\left( B \right)\)</span> are on or outside the unit circle. This means that nonstationary and noninvertible components are allowed. Since different roots of the AR polynomial induce peaks in the spectrum<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> of the series at different frequencies, and given that different components are associated with the spectral peaks for different frequencies, it is assumed that for <span class="math inline">\(i \neq j\)</span> the polynomials<span class="math inline">\(\ \phi_{i}\left( B \right)\)</span> and <span class="math inline">\(\phi_{j}\left( B \right)\)</span> do not share any common root (they are coprime). Finally, it is assumed that the polynomials <span class="math inline">\(\theta_{i}\left( B \right),\ i = 1,\ldots,k\)</span> are prime share no unit root in common, guaranteeing the invertibility of the overall series. In fact, since the unit root of <span class="math inline">\(\theta_{i}\left( B \right)\)</span> induce a spectral zero, when the polynomials <span class="math inline">\(\theta_{i}\left( B \right),\ i = 1,\ldots,k\)</span> share no unit root in common, there is no frequency for which all component spectra become zero<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>.</p>
<p>Since aggregation of ARIMA models yields ARIMA models, the series <span class="math inline">\(x_{t}\)</span> will also follow an ARIMA model, as in <a href="M-tests.html#eq-2">Equation&nbsp;<span>2</span></a> <!---\[7.26\]-->, and consequently the following identity can be derived:</p>
<p><span id="eq-5"><span class="math display">\[
\frac{\theta(B)}{\varphi(B)}a_{t} = \sum_{i = 1}^{k}{\frac{\theta_{i}(B)}{\varphi_{i}(B)}a_{\text{it}}}
\tag{5}\]</span></span> <!---\[7.29\]--></p>
<p>In the ARIMA model based approach implemented in SEATS, the ARIMA model identified and estimated for the observed series <span class="math inline">\(x_{t}\)</span> is decomposed to derive the models for the components. In particular, the AR polynomials for the components, <span class="math inline">\(\varphi_{i}\left( B \right)\)</span>, are easily derived through the factorization of the AR polynomial <span class="math inline">\(\varphi\left( B \right)\)</span>:</p>
<p><span id="eq-6"><span class="math display">\[
\varphi\left( B \right) = \prod_{i = 1}^{k}{\varphi_{i}\left( B \right)}
\tag{6}\]</span></span> <!---\[7.30\]--></p>
<p>while the MA polynomials for the components, together with the innovation variances <span class="math inline">\(V(a_{i})\)</span>, cannot simply be obtained through the relationship:</p>
<p><span id="eq-7"><span class="math display">\[
\theta(B)a_{t} = \sum_{i = 1}^{k}{\varphi_{\text{ni}}\left( B \right)}\theta_{i}(B)a_{\text{it}}
\tag{7}\]</span></span> <!---\[7.31\]--></p>
<p>where <span class="math inline">\(\varphi_{\text{ni}}\left( B \right)\)</span> is the product of all <span class="math inline">\(\varphi_{j}\left( B \right),\ j = 1,\ldots,k\)</span>, except from <span class="math inline">\(\varphi_{i}\left( B \right)\)</span>. Further assumptions are therefore needed to cope with the underidentification problem: i) <span class="math inline">\(p_{i} \geq q_{i}\)</span> and ii) the canonical decomposition, i.e.&nbsp;the decomposition that allocate all additive white noise to the irregular component (yielding noninvertible components except the irregular).</p>
<p>To understand how SEATS factorizes the AR polynomials, first a concept of a root will be explored<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>.</p>
<p>The equation <a href="M-tests.html#eq-2">Equation&nbsp;<span>2</span></a> <!---\[7.26\]--> can be expressed as:</p>
<p><span id="eq-8"><span class="math display">\[
\psi^{- 1}(B)x_{t} = a_{t}(1 + \varphi_{1}B + \ldots\varphi_{p}B^{p})x_{t} =(1 + \theta_{1}B + \ldots\theta_{q}B^{q})a_{t}
\tag{8}\]</span></span> <!---\[7.32\]--></p>
<p>Let us now consider <a href="M-tests.html#eq-2">Equation&nbsp;<span>2</span></a> <!---\[7.26\]--> in the inverted form:</p>
<p><span id="eq-9"><span class="math display">\[
\theta\left( B \right)y_{t} = \varphi(B)a_{t}
\tag{9}\]</span></span> <!---\[7.33\]--></p>
<p>If both sides of <a href="#eq-8">Equation&nbsp;<span>8</span></a> <!---\[7.32\]--> are multiplied by <span class="math inline">\(x_{t - k}\)</span> with <span class="math inline">\(k &gt; q\)</span>, and expectations are taken, the right hand side of the equation vanishes and the left hand side becomes:</p>
<p><span id="eq-10"><span class="math display">\[
\varphi(B)\gamma_{k} = \gamma_{k} + \varphi_{1}\gamma_{k - 1} + \ldots\varphi_{p}\gamma_{k - p} = 0
\tag{10}\]</span></span> <!---\[7.34\]--></p>
<p>where <span class="math inline">\(B\)</span> operates on the subindex <span class="math inline">\(k\)</span>.</p>
<p>The autocorrelation function <span class="math inline">\(\gamma_{k}\)</span> is a solution of <a href="#eq-10">Equation&nbsp;<span>10</span></a> <!---\[7.34\]--> with the characteristic equation:</p>
<p><span id="eq-11"><span class="math display">\[
z^{p} + \varphi_{1}z^{p - 1} + \ldots\varphi_{p - 1}z + \varphi_{p} = 0
\tag{11}\]</span></span> <!---\[7.35\]--></p>
<p>If <span class="math inline">\(z_{1}\)</span>,…,<span class="math inline">\(\ z_{p}\)</span> are the roots of <a href="#eq-11">Equation&nbsp;<span>11</span></a> <!---\[7.35\]-->, the solutions of <a href="#eq-10">Equation&nbsp;<span>10</span></a> <!---\[7.34\]--> can be expressed as:</p>
<p><span id="eq-12"><span class="math display">\[
\gamma_{k} = \sum_{i = 1}^{p}z_{i}^{k}
\tag{12}\]</span></span> <!---\[7.36\]--></p>
<p>and will converge to zero as <span class="math inline">\(k \rightarrow \infty\)</span> when <span class="math inline">\(\left| r_{i} \right| &lt; 1,\ i = 1,\ldots,p\)</span>. From <a href="#eq-10">Equation&nbsp;<span>10</span></a> <!---\[7.34\]--> and <a href="#eq-12">Equation&nbsp;<span>12</span></a> <!---\[7.36\]--> it can be noticed that <span class="math inline">\(z_{1} = B_{i}^{- 1}\)</span>, meaning that <span class="math inline">\(z_{1}\)</span>,…,<span class="math inline">\(\ z_{p}\)</span> are the inverses of the roots <span class="math inline">\(B_{1},\ldots,B_{p}\)</span> of the polynomial <span class="math inline">\(\varphi(B)\)</span>. The convergence of <span class="math inline">\(\gamma_{k}\)</span> implies that the roots of the <span class="math inline">\(\varphi(B)\)</span> are larger than 1 in modulus (lie outside the unit circle). Therefore, from the equation</p>
<p><span id="eq-13"><span class="math display">\[
{\varphi(B)}^{- 1} = \frac{1}{(1 - z_{1})\ldots(1 - z_{1})}
\tag{13}\]</span></span> <!---\[7.37\]--></p>
<p>it can be derived that <span class="math inline">\({\varphi(B)}^{- 1}\)</span> is convergent and all its inverse roots are less than 1 in modulus.</p>
<p>Equation <a href="#eq-11">Equation&nbsp;<span>11</span></a> <!---\[7.35\]--> has real and complex roots (solutions). Complex number <span class="math inline">\(x = a + bi\)</span>, with <span class="math inline">\(a\)</span> and <span class="math inline">\(\text{b}\)</span> both real numbers, can be represented as <span class="math inline">\(x = r\left( cos(\omega) + i\ sin(\omega \right))\)</span>, where <span class="math inline">\(i\)</span> is the imaginary unit<span class="math inline">\({\ (i}^{2} = - 1)\)</span>, <span class="math inline">\(r\)</span> is the modulus of <span class="math inline">\(x\)</span>, that is <span class="math inline">\(\ r = \left| x \right| = \sqrt{a^{2} + b^{2}}\)</span> and <span class="math inline">\(\omega\)</span> is the argument (frequency). When roots are complex, they are always in pairs of complex conjugates. The representation of the complex number <span class="math inline">\(x = a + bi\)</span> has a geometric interpretation in the complex plane established by the real axis and the orthogonal imaginary axis.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="All_images/UG_A_image3.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Geometric representation of a complex number and of its conjugate</strong></figcaption>
</figure>
</div>
<p>Representing the roots of the characteristic equation <a href="#eq-11">Equation&nbsp;<span>11</span></a> <!---\[7.35\]--> in the complex plane enhances understanding how they are allocated to the components. When the modulus <span class="math inline">\(r\)</span> of the roots in <span class="math inline">\(\text{z}\)</span> are greater than 1 (i.e.&nbsp;modulus of the roots in <span class="math inline">\(\varphi(B)\  &lt; 1\)</span>), the solution of the characteristic equation has a systematic explosive process, which means that the impact of the given impulse on the time series is more and more pronounced in time. This behaviour is not in line with the developments that can be identified in actual economic series. Therefore, the models estimated by TRAMO-SEATS (and X-13ARIMA-SEATS) have never inverse roots in <span class="math inline">\(B\)</span> with modulus greater than 1.</p>
<p>The characteristic equations associated with the regular and the seasonal differences have roots in <span class="math inline">\(\varphi(B)\)</span> with modulus <span class="math inline">\(r = 1\)</span>. They are called non-stationary roots and can be represented on the unit circle. Let us consider the seasonal differencing operator applied to a quarterly time series <span class="math inline">\((1 - B^{4})\)</span>. Its characteristic equation is <span class="math inline">\({(z}^{4} - 1) = 0\)</span> with solutions given by<span class="math inline">\(\ z = \sqrt[4]{1}\)</span>, i.e. <span class="math inline">\(z_{1,2} = \pm 1\)</span> and <span class="math inline">\(z_{3,4} = \pm i1\)</span>. The first two solutions are real and the last two are complex conjugates. They are represented by the black points on the unit circle on the figure below.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="All_images/UG_A_image4.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Unit roots on the unit circle</strong></figcaption>
</figure>
</div>
<p>For the seasonal differencing operator <span class="math inline">\((1 - B^{12})\)</span> applied to the monthly time series the characteristic equation <span class="math inline">\({\ (z}^{12} - 1) = 0\)</span> has twelve non-stationary solutions given by<span class="math inline">\(\ z = \sqrt[12]{1}:\)</span> two real and ten complex conjugates, represented by the white circles in unit roots figure above.</p>
<p>The complex conjugates roots generate the periodic movements of the type:</p>
<p><span id="eq-14"><span class="math display">\[
z_{t} = A^{t}\cos\left( \omega t + W \right).
\tag{14}\]</span></span> <!---\[7.38\]--></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(A\)</span> – amplitude;</p></li>
<li><p><span class="math inline">\(\omega\)</span> – angular frequency (in radians);</p></li>
<li><p><span class="math inline">\(W\)</span> – phase (angle at <span class="math inline">\(t = 0)\)</span>.</p></li>
</ul>
<p>The frequency <span class="math inline">\(f\)</span>, i.e.&nbsp;the number of cycles per unit time, is <span class="math inline">\(\frac{\omega}{2\pi}\)</span>. If it is multiplied by <em>s</em>, the number of observations per year, the number of cycles completed in one year is derived. The period of function <a href="#eq-14">Equation&nbsp;<span>14</span></a> <!---\[7.38\]-->, denoted by <span class="math inline">\(\tau\)</span>, is the number of units of time (months/quarters) it takes for a full circle to be completed.</p>
<p>For quarterly series the seasonal movements are produced by complex conjugates roots with angular frequencies at <span class="math inline">\(\frac{\pi}{2}\)</span> (one cycle per year) and <span class="math inline">\(\pi\)</span> (two cycles per year). The corresponding number of cycles per year and the length of the movements are presented in the table below.</p>
<p><strong>Seasonal frequencies for a quarterly time series</strong></p>

<!-- {: .table .table-style} -->
<table class="table">
<colgroup>
<col style="width: 23%">
<col style="width: 23%">
<col style="width: 23%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Angular frequency (</strong><span class="math inline">\(\omega\)</span>)</th>
<th><strong>Frequency (cycles per unit time) (</strong><span class="math inline">\(f\)</span>)</th>
<th><strong>Cycles per year</strong></th>
<th><strong>Length of the movement measured in quarters (</strong><span class="math inline">\(\tau\)</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\frac{\pi}{2}\)</span></td>
<td>0.25</td>
<td>1</td>
<td>4</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\pi\)</span></td>
<td>0.5</td>
<td>2</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>For monthly time series the seasonal movements are produced by complex conjugates roots at the angular frequencies: <span class="math inline">\(\frac{\pi}{6},\frac{\pi}{3}, \frac{\pi}{2}, \frac{2\pi}{3}, \frac{5\pi}{6}\)</span> and <span class="math inline">\(\pi\)</span>. The corresponding number of cycles per year and the length of the movements are presented in the table below:</p>
<p><strong>Seasonal frequencies for a monthly time series</strong></p>

<!-- {: .table .table-style} -->
<table class="table">
<colgroup>
<col style="width: 23%">
<col style="width: 23%">
<col style="width: 23%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Angular frequency (</strong><span class="math inline">\(\omega\)</span>)</th>
<th><strong>Frequency (cycles per unit time) (</strong><span class="math inline">\(f\)</span>)</th>
<th><strong>Cycles per year</strong></th>
<th><strong>Length of the movement measured in months (</strong><span class="math inline">\(\tau\)</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\frac{\pi}{6}\)</span></td>
<td>0.083</td>
<td>1</td>
<td>12</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\frac{\pi}{3}\)</span></td>
<td>0.167</td>
<td>2</td>
<td>6</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\frac{\pi}{2}\)</span></td>
<td>0.250</td>
<td>3</td>
<td>4</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\frac{2\pi}{3}\)</span></td>
<td>0.333</td>
<td>4</td>
<td>3</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\frac{5\pi}{6}\)</span></td>
<td>0.417</td>
<td>5</td>
<td>2.4</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\pi\)</span></td>
<td>0.500</td>
<td>6</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>In JDemetra+ SEATS assigns the roots of the AR full polynomial to the components according to their associated modulus and frequency, i.e.:<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a></p>
<ul>
<li><p>Roots of <span class="math inline">\(\left( 1 - B \right)^{d}\)</span> are assigned to trend component.</p></li>
<li><p>Roots of <span class="math inline">\(\ \left( 1 - B^{s} \right)^{d_{s}} = {((1 - B)(1 + B + \ldots + B^{s - 1}))}^{d_{s}}\)</span> are assigned to the trend component (root of <span class="math inline">\({\left( 1 - B \right)}^{d_{s}}\)</span>) and to the seasonal component (roots of <span class="math inline">\({(1 + B + \ldots + B^{s - 1})}^{d_{s}}\)</span>).</p></li>
<li><p>When the modulus of the inverse of a real positive root of <span class="math inline">\(\varphi(B)\)</span> is greater than <span class="math inline">\(k\)</span> or equal to <span class="math inline">\(k\)</span>, where <span class="math inline">\(k\)</span> is the threshold value controlled by the <em>Trend boundary</em> parameter(in the original SEATS it is controlled by <em>rmod</em>)<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>, then the root is assigned to the trend component. Otherwise it is assigned to the transitory component.</p></li>
<li><p>Real negative inverse roots of <span class="math inline">\(\text{ϕ}_{p}\left( B \right)\)</span> associated with the seasonal two-period cycle are assigned to the seasonal component if their modulus is greater than <em>k</em>, where <span class="math inline">\(k\)</span> is the threshold value controlled by the <em>Seasonal boundary</em> and the <em>Seas. boundary (unique)</em> parameters. Otherwise they are assigned to the transitory component.</p></li>
<li><p>Complex roots, for which the argument (angular frequency) is close enough to the seasonal frequency are assigned to the seasonal component. Closeness is controlled by the <em>Seasonal tolerance</em> and <em>Seasonal tolerance (unique)</em> parameters (in the original SEATS it is controlled by <em>epsphi</em>). Otherwise they are assigned to the transitory component.</p></li>
<li><p>If <span class="math inline">\(d_{s}\)</span> (seasonal differencing order) is present and <span class="math inline">\(\text{Bphi} &lt; 0\)</span> (<span class="math inline">\(\text{Bphi}\)</span> is the estimate of the seasonal autoregressive parameter), the real positive inverse root is assigned to the trend component and the other (<span class="math inline">\(s - 1\)</span>) inverse roots are assigned to the seasonal component. When <span class="math inline">\(d_{s} = 0\)</span>, the root is assigned to the seasonal when <span class="math inline">\(\text{Bphi} &lt; - 0.2\)</span> and/or the overall test for seasonality indicates presence of seasonality. Otherwise it goes to the transitory component. Also, when <span class="math inline">\(\text{Bphi} &gt; 0\)</span>, roots are assigned to the transitory component.</p></li>
</ul>
<p>For further details about JDemetra+ parameters see section <a href="../reference-manual/sa-spec-tramo.html">TramoSeats</a>.</p>
<p>It should be highlighted that when<span class="math inline">\(\ Q &gt; P\)</span>, where <span class="math inline">\(Q\)</span> and <span class="math inline">\(P\)</span> denote the orders of the polynomials <span class="math inline">\(\varphi\left( B \right)\)</span> and <span class="math inline">\(\theta(B)\)</span>, the SEATS decomposition yields a pure MA <span class="math inline">\((Q - P)\)</span> component (hence transitory). In this case the transitory component will appear even when there is no AR factor allocated to it.</p>
<p>Once these rules are applied, the factorization of the AR polynomial presented by <a href="M-tests.html#eq-2">Equation&nbsp;<span>2</span></a> <!---\[7.26\]--> yields to the identification of the AR polynomials for the components which contain, respectively, the AR roots associated with the trend component, the seasonal component and the transitory component.<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a></p>
<p>Then with the partial fraction expansion the spectrum of the final components are obtained.</p>
<p>For example, the Airline model for a monthly time series:</p>
<p><span id="eq-15"><span class="math display">\[
(1 - B)(1 - B^{12})x_{t} = (1 + \theta_{1}B)(1 + \Theta_{1}B^{12})\ a_{t}
\tag{15}\]</span></span> <!---\[7.39\]--></p>
<p>is decomposed by SEATS into the model for the trend component:</p>
<p><span id="eq-16"><span class="math display">\[
(1 - B)(1 - B)c_{t} = (1 + \theta_{c,1}B + \theta_{c,2}B^{2})a_{c,t}
\tag{16}\]</span></span> <!---\[7.40\]--></p>
<p>and the model for the seasonal component:</p>
<p><span id="eq-17"><span class="math display">\[
\left( 1 + B + \ldots + B^{11} \right)s_{t} = \left( 1 + \theta_{s,1}B + \ldots + {\theta_{s,11}B}^{11} \right)a_{s,t},
\tag{17}\]</span></span> <!---\[7.41\]--></p>
<p>As a result, the Airline model is decomposed as follows: <span id="eq-18"><span class="math display">\[
\small
\frac{(1 + \theta_{1}B)(1 + \Theta_{1}B^{12})}{(1 - B)(1 - B)}a_{t} = \frac{\left( 1 + \theta_{s,1}B + \ldots + {\theta_{s,11}B}^{11} \right)}{\left( 1 + B + \ldots + B^{11} \right)}a_{s,t} + \frac{(1 + \theta_{c,1}B + \theta_{c,2}B^{2})}{(1 - B)(1 - B)}a_{c,t} + u_{t}
\tag{18}\]</span></span> <!---\[7.42\]--></p>
<p>The transitory component is not present in this case and the irregular component is the white noise.</p>
<p>The partial fractions decomposition is performed in a frequency domain. In essence, it consists in portioning of the pseudo-spectrum<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a> of <span class="math inline">\(x_{t}\)</span> into additive spectra of the components. When the AMB decomposition of the ARIMA model results in the non-negative spectra for all components, the decomposition is called admissible<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a>. In such case an infinite number of admissible decompositions exists, i.e. decompositions that yield the non-negative spectra of all components. Therefore, the MA polynomials and the innovation variances cannot be yet identified from the model of <span class="math inline">\(x_{t}\)</span>. As sketched above, to solve this underidentification problem and identify a unique decomposition, it is assumed that for each component the order of the MA polynomial is no greater than the order of the AR polynomial and the canonical solution of S.C. Hillmer and G.C. Tiao is applied<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a>, i.e.&nbsp;all additive white noise is added to the irregular component As a consequence all components derived from the canonical decomposition, except from the irregular, have a spectral minimum of zero and are thus noninvertible<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a>. Given the stochastic features of the series, it can be shown by that the canonical decomposition produces as stable as possible trend and seasonal components since it maximizes the variance of the irregular and minimizes the variance of the other components<a href="#fn15" class="footnote-ref" id="fnref15" role="doc-noteref"><sup>15</sup></a>. However, there is a price to be paid as canonical components can produce larger revisions in the preliminary estimators of the component<a href="#fn16" class="footnote-ref" id="fnref16" role="doc-noteref"><sup>16</sup></a> than any other admissible decomposition.</p>
<p>The figure below represents the pseudo-spectrum for the canonical trend and an admissible trend.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="All_images/UG_A_image5.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>A comparison of canonical trend and admissible trend</strong></figcaption>
</figure>
</div>
<p>A pseudo-spectrum is denoted by<span class="math inline">\(\ g_{i}(\omega)\)</span>, where <span class="math inline">\(\omega\)</span> represents the angular frequency. The pseudo-spectrum of <span class="math inline">\(x_{\text{it}}\)</span> is defined as the Fourier transform of ACGF of<span class="math inline">\(\ x_{t}\)</span> which is expressed as:</p>
<p><span id="eq-19"><span class="math display">\[
\frac{\psi_{i}\left( B \right)\psi_{i}\left( F \right)}{\delta_{i}\left( B \right)\delta_{i}\left( F \right)}V(a_{i})
\tag{19}\]</span></span> <!---\[7.43\]--></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(\psi_{i}\left( F \right) = \frac{\theta_{i}\left( F \right)}{\phi_{i}\left( F \right)}\)</span></p></li>
<li><p><span class="math inline">\(\psi_{i}\left( B \right) = \frac{\theta_{i}\left( B \right)}{\phi_{i}\left( B \right)}\)</span></p></li>
<li><p><span class="math inline">\(B\)</span> is the backward operator,</p></li>
<li><p><span class="math inline">\(F\)</span> is the forward operator.</p></li>
</ul>
<p>A pseudo-spectrum for a monthly time series <span class="math inline">\(x_{t}\)</span> is presented in the figure below: The pseudo-spectrum for a monthly series. The frequency <span class="math inline">\(\omega = 0\)</span> is associated with the trend, frequencies in the range [<span class="math inline">\(0 + \epsilon_{1},\ \frac{\pi}{6} - \epsilon_{2}\)</span>] with <span class="math inline">\(\left[0 + \epsilon_{1},\ \frac{\pi}{6} - \epsilon_{2}\right]\)</span> <span class="math inline">\(\epsilon_{1},\ \epsilon_{2} &gt; 0\)</span> and <span class="math inline">\(\epsilon_{1} &lt; \ \frac{\pi}{6} - \epsilon_{2}\)</span> are usually associated with the business-cycle and correspond to a period longer than a year and bounded<a href="#fn17" class="footnote-ref" id="fnref17" role="doc-noteref"><sup>17</sup></a>. The frequencies in the range [<span class="math inline">\(\frac{\pi}{6},\pi\)</span>] are associated with the short term movements, whose cycle is completed in less than a year. If a series contains an important periodic component, its spectrum reveals a peak around the corresponding frequency and in the ARIMA model it is captured by an AR root. In the example below spectral peaks occur at the frequency <span class="math inline">\(\omega = 0\)</span> and at the seasonal frequencies ( <span class="math inline">\(\frac{\pi}{6}\)</span>, <span class="math inline">\(\frac{2\pi}{6},\ \frac{3\pi}{6},\ \frac{4\pi}{6},\frac{5\pi}{6},\pi\)</span>). <a href="#fn18" class="footnote-ref" id="fnref18" role="doc-noteref"><sup>18</sup></a></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="All_images/UG_A_image6.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>The pseudo-spectrum for a monthly series</strong></figcaption>
</figure>
</div>
<p>In the decomposition procedure, the pseudo-spectrum of the time series <span class="math inline">\(x_{t}\)</span> is divided into the spectra of its components (in the example figure below, four components were obtained).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="All_images/UG_A_image7.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>The pseudo-spectra for the components</strong></figcaption>
</figure>
</div>
</section>
<section id="estimation-of-the-components-with-the-wiener-kolmogorow-filter" class="level2">
<h2 class="anchored" data-anchor-id="estimation-of-the-components-with-the-wiener-kolmogorow-filter">Estimation of the components with the Wiener-Kolmogorow filter</h2>
<p>The various components are estimated using Wiener-Kolmogorow (WK) filters. JDemetra+ includes three options to estimate the WK filter, namely <em>Burman</em>, <em>KalmanSmoother</em> and <em>MCElroyMatrix</em><a href="#fn19" class="footnote-ref" id="fnref19" role="doc-noteref"><sup>19</sup></a>. Here the first of abovementioned options, proposed by BURMAN, J.P. (1980) will be explained.</p>
<p>The estimation procedure and the properties of the WK filter are easier to explain with a two-component model. Let the seasonally adjusted series (<span class="math inline">\(s_{t}\)</span>) be the signal of interest and the seasonal component (<span class="math inline">\(n_{t}\)</span>) be the remainder, “the noise”. The series is given by the model <a href="M-tests.html#eq-2">Equation&nbsp;<span>2</span></a> <!---\[7.26\]--> and from <a href="#eq-4">Equation&nbsp;<span>4</span></a> <!---\[7.28\]--> the models for theoretical components are:</p>
<p><span id="eq-20"><span class="math display">\[
\varphi_{s}(B)s_{t} = \theta_{s}(B)a_{\text{st}}
\tag{20}\]</span></span> <!---\[7.44\]--></p>
<p>and</p>
<p><span id="eq-21"><span class="math display">\[
\varphi_{n}(B)n_{t} = \theta_{n}(B)a_{\text{nt}}
\tag{21}\]</span></span> <!---\[7.45\]--></p>
<p>From <a href="#eq-6">Equation&nbsp;<span>6</span></a> <!---\[7.30\]--> and <a href="#eq-7">Equation&nbsp;<span>7</span></a> <!---\[7.31\]--> it is clear that <span class="math inline">\(\varphi\left( B \right) = \varphi_{s}(B)\varphi_{n}(B)\)</span> and <span class="math inline">\(\theta\left( B \right)a_{t} = \theta_{s}(B)a_{\text{st}}+\theta_{n}(B)a_{\text{nt}}\)</span>.</p>
<p>As the time series components are never observed, their estimators have to be used. Let us note <span class="math inline">\(X_{T}\)</span> an infinite realization of the time series <span class="math inline">\(x_{t}\)</span>. SEATS computes the Minimum Mean Square Error (MMSE) estimator of <span class="math inline">\(s_{t}\)</span>, e.g.&nbsp;the estimator <span class="math inline">\(\widehat{s}_{t}\)</span> that minimizes <span class="math inline">\(E\lbrack\left({s_{t}-{\widehat{s}}_{t})}^{2}|X_{T} \right)\rbrack\)</span>. Under the normality assumption <span class="math inline">\({\widehat{s}}_{t|T}\)</span> is also equal to the conditional expectation <span class="math inline">\(E\left(s_{t}|X_{T}\right)\)</span>, so it can be presented as a linear function of the elements in <span class="math inline">\(X_{T}\)</span>.<a href="#fn20" class="footnote-ref" id="fnref20" role="doc-noteref"><sup>20</sup></a> WHITTLE (1963) shows that the MMSE estimator of <span class="math inline">\({\widehat{s}}_{t}\)</span> is:</p>
<p><span id="eq-22"><span class="math display">\[
{\widehat{s}}_{t} = k_{s}\frac{\psi_{s}(B)\psi_{s}(F)}{\psi(B)\psi(F)}x_{t}
\tag{22}\]</span></span> <!---\[7.46\]--></p>
<p>where</p>
<ul>
<li><p><span class="math inline">\(\psi(B)= \frac{\theta(B)}{\phi(B)}\)</span>,</p></li>
<li><p><span class="math inline">\(F = B^{- 1}\)</span>,</p></li>
<li><p><span class="math inline">\(k_{s}=\frac{V(a_{s})}{V(a)}\)</span>,</p></li>
</ul>
<p><span class="math inline">\(V(a_{s})\)</span> is the variance of <span class="math inline">\(a_{st}\)</span> and <span class="math inline">\(V(a)\)</span> is the variance of <span class="math inline">\(a_{t}\)</span>.</p>
<p>Expressing the <span class="math inline">\(\psi\left(B\right)\)</span> polynomials as functions of the AR and MA polynomials, after cancelation of roots, the estimator of <span class="math inline">\(s_{t}\)</span> can be expressed as:</p>
<p><span id="eq-23"><span class="math display">\[
{\widehat{s}}_{t} = k_{s}\frac{\theta_{s}\left(B\right)\theta_{s}\left(F\right)\varphi_{n}\left(B \right)\delta_{n}\left(B\right)\varphi_{n}\left(F\right)\delta_{n}\left(F\right)}{\theta\left(B\right)\theta\left(F \right)}x_{t}
\tag{23}\]</span></span> <!---\[7.47\]--></p>
<p>where:</p>
<p><span id="eq-24"><span class="math display">\[
\nu_{s}\left( B,F \right) = k_{s}\frac{\theta_{s}\left( B \right)\theta_{s}\left( F \right)\varphi_{n}\left( B \right)\delta_{n}\left( B \right)\varphi_{n}\left( F \right)\delta_{n}\left( F \right)}{\theta\left( B \right)\theta\left( F \right)}
\tag{24}\]</span></span> <!---\[7.48\]--></p>
<p>is a WK filter.</p>
<p>Equation <a href="#eq-24">Equation&nbsp;<span>24</span></a> <!---\[7.48\]--> shows that the WK filter is two-sided (uses observations both from the past and from the future), centered (the number of points in the past is the same as in the future) and symmetric (for any <span class="math inline">\(k\)</span> the weight applied to <span class="math inline">\(x_{t - k}\)</span> and <span class="math inline">\(x_{t + k}\)</span> is the same), which allows the phase effect to be avoided. Due to invertibility of <span class="math inline">\(\theta\left( B \right)\)</span> (and <span class="math inline">\(\theta\left( F \right)\)</span>) the filter is convergent in the past and in the future.</p>
<p>The estimator can be presented as</p>
<p><span id="eq-25"><span class="math display">\[
{\widehat{s}}_{t} = \nu_{i}\left(B,F\right)x_{t}
\tag{25}\]</span></span> <!---\[7.49\]--></p>
<p>where <span class="math inline">\(\nu_{i}\left(B,F\right)=\nu_{0}+ \sum_{j = 1}^{\infty}\nu_{ij}(B^{j}+F^{j})\)</span> is the WK filter.</p>
<p>The example of the WK filters obtained for the pseudo-spectra of the series illustrated above is shown on the figure below: WK filters for components.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="All_images/UG_A_image8.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>WK filters for components</strong></figcaption>
</figure>
</div>
<p>The WK filter from <a href="#eq-24">Equation&nbsp;<span>24</span></a> <!---\[7.48\]--> can also be expressed as a ratio of two pseudo-autocovariance generating functions (p-ACGF). The p-ACGF function summarizes the sequence of absolutely summable autocovariances of a stationary process <span class="math inline">\(x_{t}\)</span> (see section section <a href="..\theory\spectral.html">Spectral Analysis</a>).</p>
<p>The ACGF function of an ARIMA process is expressed as:</p>
<p><span id="eq-26"><span class="math display">\[
acgf(B) = \frac{\theta\left( B \right)\theta\left( F \right)}{\phi\left( B \right)\delta\left( B \right)\phi\left( F \right)\delta\left( F \right)}V(a)
\tag{26}\]</span></span> <!---\[7.50\]--></p>
<p>And, the WK filter can be rewritten as:</p>
<p><span id="eq-27"><span class="math display">\[
\nu_{s}\left( B,F \right) = \frac{\gamma_{s}(B,F)}{\gamma(B,F)}
\tag{27}\]</span></span> <!---\[7.51\]--></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(\gamma_{s}\left( B,F \right) = \frac{\theta_{s}\left( B \right)\theta_{s}\left( F \right)}{\phi_{s}\left( B \right)\delta_{s}\left( B \right)\phi_{s}\left( F \right)\delta_{s}\left( F \right)}V(a_{s})\)</span> is the p-ACGF of <span class="math inline">\(s_{t}\)</span>;</p></li>
<li><p><span class="math inline">\(\gamma\left( B,F \right) = \frac{\theta\left( B \right)\theta\left( F \right)}{\phi\left( B \right)\delta\left( B \right)\phi\left( F \right)\delta\left( F \right)}V(a)\)</span> is the p-ACGF of <span class="math inline">\(x_{t}\)</span>.</p></li>
</ul>
<p>From <a href="#eq-24">Equation&nbsp;<span>24</span></a> <!---\[7.48\]--> it can be seen that the WK filter depends on both the component and the series models. Consequently, the estimator of the component and the WK filter reflect the characteristic of data and by construction, the WK filter adapts itself to the series under consideration. Therefore, the ARIMA model is of particular importance for the SEATS method. Its misspecification results in an incorrect decomposition.</p>
<p>This adaptability, if the model has been correctly determined, avoids the dangers of under and overestimation with an ad-hoc filtering. For example, for the series with a highly stochastic seasonal component the filter adapts to the width of the seasonal peaks and the seasonally adjusted series does not display any spurious seasonality<a href="#fn21" class="footnote-ref" id="fnref21" role="doc-noteref"><sup>21</sup></a>. Examples of WK filters for stochastic and stable seasonal components are presented on the figure below.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="All_images/UG_A_image9.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>WK filters for stable and stochastic seasonal components</strong></figcaption>
</figure>
</div>
<p>The derivation of the components requires an infinite realization of <span class="math inline">\(x_{t}\)</span> in the direction of the past and of the future. However, the convergence of the WK filter guarantees that, in practice, it could be approximated by a truncated (finite) filter and, in most applications, for large <span class="math inline">\(k\)</span> the estimator for the central periods of the series can be safely seen as generated by the WK filter<a href="#fn22" class="footnote-ref" id="fnref22" role="doc-noteref"><sup>22</sup></a>:</p>
<p><span id="eq-28"><span class="math display">\[
{\widehat{s}}_{t}=\nu_{k}x_{t-k} + \ldots + \nu_{0}x_{t} + \ldots + \nu_{k}x_{t+k}
\tag{28}\]</span></span> <!---\[7.52\]--></p>
<p>When <span class="math inline">\(T &gt; 2L + 1\)</span>, where <span class="math inline">\(T\)</span> is the last observed period, and <span class="math inline">\(L\)</span> is an a priori number that typically expands between 3 and 5 years, the estimator expressed by <a href="#eq-23">Equation&nbsp;<span>23</span></a> <!---\[7.47\]--> can be assumed as the final (historical) estimator for the central observations of the series<a href="#fn23" class="footnote-ref" id="fnref23" role="doc-noteref"><sup>23</sup></a>. In practice, the Wiener-Kolmogorov filter is applied to <span class="math inline">\(x_{t}\)</span> extended with forecasts and backcasts from the ARIMA model. The final or historical estimator of <span class="math inline">\({\widehat{s}}_{t}\)</span>, is obtained with a doubly infinite filter, and therefore contains an error <span class="math inline">\(e_{st}\)</span> called final estimation error, which is equal <span class="math inline">\(e_{st}=s_{t}-{\widehat{s}}_{t}\)</span>.</p>
<p>In the frequency domain, the Wiener-Kolmogorov filter<span class="math inline">\(\ \nu(B,F)\)</span> that provides the final estimator of <span class="math inline">\(s_{t}\)</span> is expressed as the ratio of the <span class="math inline">\(s_{t}\)</span> and <span class="math inline">\(x_{t}\)</span> pseudo-spectra:</p>
<p><span id="eq-29"><span class="math display">\[
\widetilde{\nu}\left( \omega \right) = \frac{g_{s}(\omega)}{g_{x}(\omega)}
\tag{29}\]</span></span> <!---\[7.53\]--></p>
<p>The function <span class="math inline">\(\widetilde{\nu}\left( \omega \right)\)</span> is also referred as the gain of the filter.<a href="#fn24" class="footnote-ref" id="fnref24" role="doc-noteref"><sup>24</sup></a> GÓMEZ, V., and MARAVALL, A. (2001a) show that when for some frequency the signal (the seasonally adjusted series) dominates the noise (seasonal fluctuations) the gain <span class="math inline">\(\widetilde{\nu}\left( \omega \right)\)</span> approaches 1. On the contrary, when for some frequency the noise dominates the gain <span class="math inline">\(\widetilde{\nu}\left( \omega \right)\)</span> approaches 0.</p>
<p>The spectrum of the estimator of the seasonal component is expressed as:</p>
<p><span id="eq-30"><span class="math display">\[
g_{\widehat{s}}\left( \omega \right) = \left\lbrack \frac{g_{s}(\omega)}{g_{x}(\omega)} \right\rbrack^{2}g_{x}(\omega)
\tag{30}\]</span></span> <!---\[7.54\]--></p>
<p>where</p>
<ul>
<li><span class="math inline">\(\ \left\lbrack \widetilde{\nu}\left( \omega \right) \right\rbrack^{2} = \left\lbrack \frac{g_{s}(\omega)}{g_{x}(\omega)} \right\rbrack^{2} = \left\lbrack \frac{g_{s}(\omega)}{g_{s}(\omega) + g_{n}(\omega)} \right\rbrack^{2} = \left\lbrack \frac{1}{1 + \frac{1}{r(\omega)}} \right\rbrack^{2}\)</span> is the squared gain of the filter ;</li>
<li><span class="math inline">\(r\left( \omega \right) = \frac{g_{s}(\omega)}{g_{n}(\omega)}\)</span> represents the signal-to-noise ratio.</li>
</ul>
<p>For each <span class="math inline">\(\omega\)</span>, the MMSE estimation gives the signal-to-noise ratio. If this ratio is high, then the contribution of that frequency to the estimation of the signal will be also high. Assume that the trend is a signal that needs to be extracted from a seasonal time series. Then <span class="math inline">\(R\left( 0 \right) = 1\)</span> and the frequency <span class="math inline">\(\omega = 0\)</span> will only be used for trend estimations. For seasonal frequencies <span class="math inline">\(R\left( \omega \right) = 0\)</span>, so that these frequencies are ignored in computing the trend resulting in spectral zeros in <span class="math inline">\(g_{\widehat{s}}\left( \omega \right)\)</span>. For this reason, unlike the spectrum of the component, the component spectrum contains dips as it can be seen on the figure below: Component spectrum and estimator spectrum for trend.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="All_images/UG_A_image10.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Component spectrum and estimator spectrum for trend</strong></figcaption>
</figure>
</div>
<p>From the equation <a href="#eq-29">Equation&nbsp;<span>29</span></a> <!---\[7.53\]--> it is clear that the squared gain of the filter determines how the variance of the series contributes to the variance of the seasonal component for the different frequencies. When <span class="math inline">\(\widetilde{\nu}\left( \omega \right) = 1\)</span>, the full variation of <span class="math inline">\(x_{t}\)</span> for that frequency is passed to <span class="math inline">\({\widehat{s}}_{t}\)</span>, while if <span class="math inline">\(\widetilde{\nu}\left(\omega\right) = 0\)</span> the variation of <span class="math inline">\(x_{t}\)</span> for that frequency is fully ignored in the computation of <span class="math inline">\({\widehat{s}}_{t}\)</span>. These two cases are well illustrated by the figure below that shows the square gain of the WK filter for two series already analysed in the figure above (Figure: WK filters for stable and stochastic seasonal components).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="All_images/UG_A_image11.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>The squared gain of the WK filter for stable and stochastic seasonal components.</strong></figcaption>
</figure>
</div>
<p>Since <span class="math inline">\(r\left( \omega \right) \geq 0\)</span>, then <span class="math inline">\(\widetilde{\nu}\left( \omega \right) \leq 1\)</span> and from <a href="#eq-29">Equation&nbsp;<span>29</span></a> <!---\[7.53\]--> it can be derived that <span class="math inline">\(g_{\widehat{s}}\left( \omega \right) = \widetilde{\nu}\left( \omega \right)g_{s}(\omega)\)</span>. As a result, the estimator will always underestimate the component, i.e. it will be always more stable that the component.<a href="#fn25" class="footnote-ref" id="fnref25" role="doc-noteref"><sup>25</sup></a></p>
<p>Since <span class="math inline">\(g_{\widehat{n}}\left( \omega \right) &lt; g_{n}\left( \omega \right)\)</span> and<span class="math inline">\(\ g_{\widehat{s}}\left( \omega \right) &lt; g_{s}\left( \omega \right)\)</span> the expression: <span class="math inline">\(g_{x}\left( \omega \right) - \left\lbrack g_{\widehat{n}}\left( \omega \right) + g_{\widehat{s}}\left( \omega \right) \right\rbrack \geq 0\)</span> is the cross-spectrum. As it is positive, the MMSE yields correlated estimators. This effect emerges since variance of estimator is smaller than the variance of component. Nevertheless, if at least one non-stationary component exists, cross-correlations estimated by TRAMO-SEATS will tend to zero as cross-covariances between estimators of the components are finite. In practice, the inconvenience caused by this property will likely be of little relevance.</p>
<p><strong>Preliminary estimators for the components</strong></p>
<p>GÓMEZ, V., and MARAVALL, A. (2001a) point out that <em>the properties of the estimators have been derived for the final (or historical) estimators. For a finite (long enough) realization, they can be assumed to characterize the estimators for the central observations of the series, but for periods close to the beginning of the end the filter cannot be completed and some preliminary estimator has to be used</em>. Indeed, the historical estimator shown in <a href="#eq-28">Equation&nbsp;<span>28</span></a><!---\[7.52\]--> is obtained for the central periods of the series. However, when <span class="math inline">\(t\)</span> approaches <span class="math inline">\(T\)</span> (last observation), the WK filter requires observations, which are not available yet. For this reason a preliminary estimator needs to be used.</p>
<p>To introduce preliminary estimators let us consider a semi-finite realization <span class="math inline">\(\lbrack x_{- \infty}\)</span>,…<span class="math inline">\(\ x_{T}\)</span>], where <span class="math inline">\(T\)</span> is the last observed period. The preliminary estimator of <span class="math inline">\(x_{\text{it}}\)</span> obtained at <span class="math inline">\(T\)</span>, <span class="math inline">\((T - t = k \geq 0)\)</span> can be expressed as</p>
<p><span id="eq-31"><span class="math display">\[
{\widehat{x}}_{it|t + k}=\nu_{i}\left(B,F\right)x_{t|T}^{e}
\tag{31}\]</span></span> <!---\[7.55\]--></p>
<p>where</p>
<ul>
<li><p><span class="math inline">\(\nu_{i}\left(B,F \right)\)</span> is the WK filter ;</p></li>
<li><p><span class="math inline">\(x_{t|T}^{e}\)</span> is the extended series, such that <span class="math inline">\(x_{t|T}^{e} = x_{t}\)</span> for <span class="math inline">\(t \leq T\)</span> and <span class="math inline">\(x_{t|T}^{e}={\widehat{x}}_{t|T}\)</span> for <span class="math inline">\(t&gt;T\)</span>, where <span class="math inline">\({\widehat{x}}_{t|T}\)</span> denotes the forecast of <span class="math inline">\(x_{t}\)</span> obtained at period <span class="math inline">\(T\)</span>.</p></li>
</ul>
<p>The future <span class="math inline">\(k\)</span> values necessary to apply the filter are not yet available and are replaced by their optimal forecasts from the ARIMA model on <span class="math inline">\(x_{t}\)</span>. When <span class="math inline">\(k=0\)</span> the preliminary estimator becomes the concurrent estimator. As the forecasts are linear functions of present and past observations of <span class="math inline">\(x_{t}\)</span>, the preliminary estimator <span class="math inline">\({\widehat{x}}_{it}\)</span> will be a truncated asymmetric filter applied to <span class="math inline">\(x_{t}\)</span> that generates a phase effect<a href="#fn26" class="footnote-ref" id="fnref26" role="doc-noteref"><sup>26</sup></a>.</p>
<p>When a new observation <span class="math inline">\(x_{T + 1}\)</span> becomes available the forecast <span class="math inline">\({\widehat{x}}_{T + 1|T}\)</span> is replaced by the observation and the forecast <span class="math inline">\({\widehat{x}}_{iT + j|T}\)</span>, <span class="math inline">\(j &gt; 1\)</span> are updated to <span class="math inline">\(x_{T + j|T + 1}\)</span> resulting in the revision error<a href="#fn27" class="footnote-ref" id="fnref27" role="doc-noteref"><sup>27</sup></a>. The total error in the preliminary estimator <span class="math inline">\(d_{it|t + k}\)</span> is expressed as a sum of the final estimation error (<span class="math inline">\(e_{it}\)</span>) and the revision error (<span class="math inline">\(r_{it|t + k}\)</span>), i.e.:</p>
<p><span id="eq-32"><span class="math display">\[
d_{it|t + k} = x_{it}-{\widehat{x}}_{it|t + k} = \left(x_{it} - {\widehat{x}}_{it}\right) + \left(          {\widehat{x}}_{it} - {\widehat{x}}_{it|t + k} \right) = e_{it} + r_{it|t + k}
\tag{32}\]</span></span> <!---\[7.56\]--></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(x_{it}-i^{th}\)</span> component;</p></li>
<li><p><span class="math inline">\({\widehat{x}}_{it|t + k}\)</span>- the estimator of <span class="math inline">\(x_{it}\)</span> when the last observation is <span class="math inline">\(x_{t + k}\)</span>.</p></li>
</ul>
<p>Therefore the preliminary estimator is subject not only to the final error but also to a revision error, which are orthogonal to each other<a href="#fn28" class="footnote-ref" id="fnref28" role="doc-noteref"><sup>28</sup></a>. The revision error decreases as <span class="math inline">\(k\)</span> increases, until it can be assumed equal to 0 for large enough <span class="math inline">\(k\)</span>.</p>
<p>It’s worth remembering that SEATS estimates the unobservable components of the time series so the “true” components are never observed. Therefore, MARAVALL, A. (2009) stresses that <em>the error in the historical estimator is more of academic rather than practical interest. In practice, interest centres on revisions. (…) the revision standard deviation will be an indicator of how far we can expect to be from the optimal estimator that will be eventually attained, and the speed of convergence of</em> <span class="math inline">\({\theta\left( B \right)\ }^{- 1}\)</span> <em>will dictate the speed of convergence of the preliminary estimator to the historical one.</em> The analysis of an error is therefore useful for making decision concerning the revision policy, including the policy for revisions and horizon of revisions.</p>
</section>
<section id="psie-weights" class="level2">
<h2 class="anchored" data-anchor-id="psie-weights">PsiE-weights</h2>
<p>The estimator of the component is calculated as <span class="math inline">\({\widehat{x}}_{it} = \nu_{s}\left(B,F\right)x_{t}\)</span>. By replacing <span class="math inline">\(x_{it}=\frac{\theta(B)}{\gamma(B)\delta(B)}a_{t}\)</span>, the component estimator can be expressed as<a href="#fn29" class="footnote-ref" id="fnref29" role="doc-noteref"><sup>29</sup></a>:</p>
<p><span id="eq-33"><span class="math display">\[
{\widehat{x}}_{it} = \xi_{s}\left(B,F\right)a_{t}
\tag{33}\]</span></span> <!---\[7.57\]--></p>
<p>where <span class="math inline">\(\xi_{s}\left( B,F \right) = \ldots + \xi_{j}B^{j} + \ldots + \xi_{1}B + \xi_{0} + \xi_{- 1}F\ldots\xi_{- j}F^{j} + \ldots\)</span>.</p>
<p>This representation shows the estimator as a filter applied to the innovation <span class="math inline">\(a_{t}\)</span>, rather than on the series <span class="math inline">\(x_{t}\)</span><a href="#fn30" class="footnote-ref" id="fnref30" role="doc-noteref"><sup>30</sup></a>. Hence, the filter from <a href="#eq-32">Equation&nbsp;<span>32</span></a> <!---\[7.56\]--> can be divided into two components: the first one, i.e. <span class="math inline">\(\ldots + \xi_{j}B^{j}+ \ldots+ \xi_{1}B + \xi_{0}\)</span>, applies to prior and concurrent innovations, the second one, i.e. <span class="math inline">\(\xi_{- 1}F + \ldots + \xi_{- j}F^{j}\)</span> applies to future (i.e.&nbsp;posterior to <span class="math inline">\(t\)</span>) innovations. Consequently, <span class="math inline">\(\xi_{j}\)</span> determines the contribution of <span class="math inline">\(a_{t - j}\)</span> to <span class="math inline">\({\widehat{s}}_{t}\)</span> while <span class="math inline">\(\xi_{- j}\)</span> determines the contribution of <span class="math inline">\(a_{t + j}\)</span> to <span class="math inline">\({\widehat{s}}_{t}\)</span>. Finally, the estimator of the component can be expressed as:</p>
<p><span id="eq-34"><span class="math display">\[
{\widehat{x}}_{it} =\xi_{i}(B)^{-}a_{t} + \xi_{i}(F)^{+}a_{t + 1}
\tag{34}\]</span></span> <!---\[7.58\]--></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(\xi_{i}{(B)}^{-}a_{t}\)</span> is an effect of starting conditions, present and past innovations in series;</p></li>
<li><p><span class="math inline">\(\xi_{i}{(F)}^{+}a_{t + 1}\)</span> is an effect of future innovations.</p></li>
</ul>
<p>For the two cases already presented in figure <em>WK filters for stable and stochastic seasonal components</em> and figure <em>The squared gain of the WK filter for stable and stochastic seasonal components</em> above, the psi-weights are shown in the figure below.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="All_images/UG_A_image12.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>WK filters and squared gain of the WK filter</strong></figcaption>
</figure>
</div>
<p>It can be shown that <span class="math inline">\({\xi}_{- 1},\ldots,\xi_{- j}\)</span> are convergent and <span class="math inline">\(\xi_{j},\ldots, {\xi}_{1},\xi_{0}\)</span> are divergent. From <a href="#eq-33">Equation&nbsp;<span>33</span></a> <!---\[7.57\]-->, the concurrent estimator is equal to</p>
<p><span id="eq-35"><span class="math display">\[
{\widehat{x}}_{it|t} = E_{t}x_{it}=E_{t}{\widehat{x}}_{it} = {\xi}_{i}(B)^{-}a_{t}
\tag{35}\]</span></span> <!---\[7.59\]--></p>
<p>so that the revision</p>
<p><span id="eq-36"><span class="math display">\[
r_{it} = {\widehat{x}}_{it} - {\widehat{x}}_{it|t} = \xi_{i}(F)^{+}a_{t + 1}
\tag{36}\]</span></span> <!---\[7.60\]--></p>
<p>is a zero-mean stationary MA process. As a result, historical and preliminary estimators are cointegrated. From expression <a href="#eq-25">Equation&nbsp;<span>25</span></a> <!---\[7.49\]--> the relative size of the full revision and the speed of convergence can be obtained.</p>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>In the original software SEATS can be used either with TRAMO, operating on the input received from the latter, or alone, fitting an ARIMA model to the series.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>GÓMEZ, V., and MARAVALL, A. (1998).<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>GÓMEZ, V., and MARAVALL, A. (1997).<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>GÓMEZ, V., and MARAVALL, A. (2001a).<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>For description of the spectrum see section <a href="..\theory\spectral.html">Spectral Analysis</a>.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>MARAVALL, A. (1995).<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>Description based on KAISER, R., and MARAVALL, A. (2000) and MARAVALL, A. (2008c).<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>For details see MARAVALL, A., CAPORELLO, G., PÉREZ, D., and LÓPEZ, R. (2014).<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>In JDemetra+ this argument is called <em>Trend boundary</em>.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>The AR roots close to or at the trading day frequency generates a stochastic trading day component. A stochastic trading day component is always modelled as a stationary ARMA(2,2), where the AR part contains the roots close to the TD frequency, and the MA(2) is obtained from the model decomposition (MARAVALL, A., and PÉREZ, D. (2011)). This component, estimated by SEATS, is not implemented by the current version of JDemetra+.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>The term pseudo-spectrum is used for a non-stationary time series, while the term spectrum is used for a stationary time series.<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p>If the ARIMA model estimated in TRAMO does not accept an admissible decomposition, SEATS replaces it with a decomposable approximation. The modified model is therefore used to decompose the series. There are also other rare situations when the ARIMA model chosen by TRAMO is changed by SEATS. It happens when, for example, the ARIMA models generate unstable seasonality or produce a senseless decomposition. Such examples are discussed by MARAVALL, A. (2009).<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p>HILLMER, S.C., and TIAO, G.C. (1982).<a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14"><p>GÓMEZ, V., and MARAVALL, A. (2001a).<a href="#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn15"><p>HILLMER, S.C., and TIAO, G.C. (1982).<a href="#fnref15" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn16"><p>MARAVALL, A. (1986).<a href="#fnref16" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn17"><p>KAISER, R., and MARAVALL, A. (2000).<a href="#fnref17" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn18"><p>KAISER, R., and MARAVALL, A. (2000).<a href="#fnref18" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn19"><p>The choice of the estimation method is controlled by the <em>Method</em> parameter, explained in the <a href="../reference-manual/sa-spec-tramo.html">SEATS specification</a> section.<a href="#fnref19" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn20"><p>MARAVALL, A. (2008c).<a href="#fnref20" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn21"><p>MARAVALL, A. (1995).<a href="#fnref21" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn22"><p>MARAVALL, A., and PLANAS, C. (1999).<a href="#fnref22" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn23"><p>MARAVALL, A. (1998).<a href="#fnref23" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn24"><p>GÓMEZ, V., and MARAVALL, A. (2001a).<a href="#fnref24" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn25"><p>Ibid.<a href="#fnref25" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn26"><p>KAISER, R., and MARAVALL, A. (2000).<a href="#fnref26" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn27"><p>MARAVALL, A. (1995).<a href="#fnref27" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn28"><p>MARAVALL, A. (2009).<a href="#fnref28" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn29"><p>The section is based on KAISER, R., and MARAVALL, A. (2000).<a href="#fnref29" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn30"><p>See section PsiE-weights. For further details see MARAVALL, A. (2008).<a href="#fnref30" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./M-STL-decomposition.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">STL: Local regression decomposition</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./M-Trend-Estimation-Local-Polynomials.html" class="pagination-link">
        <span class="nav-page-text">Trend Estimation</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>